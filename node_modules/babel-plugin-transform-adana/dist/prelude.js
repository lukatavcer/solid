'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = prelude;

var _fs = require('fs');

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _babelTemplate = require('babel-template');

var _babelTemplate2 = _interopRequireDefault(_babelTemplate);

var _babelLiteralToAst = require('babel-literal-to-ast');

var _babelLiteralToAst2 = _interopRequireDefault(_babelLiteralToAst);

var _meta = require('./meta');

var _meta2 = _interopRequireDefault(_meta);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var render = (0, _babelTemplate2.default)((0, _fs.readFileSync)(_path2.default.join(__dirname, '..', 'share', 'prelude.js'), 'utf8')); /* global __dirname */

function prelude(state) {
  var coverage = (0, _meta2.default)(state);
  var name = state.file.opts.filenameRelative;
  var global = state.opts && state.opts.global || '__coverage__';
  return render({
    GLOBAL: (0, _babelLiteralToAst2.default)(global),
    SOURCE: (0, _babelLiteralToAst2.default)(coverage.source),
    TAGS: (0, _babelLiteralToAst2.default)(coverage.tags),
    VARIABLE: coverage.variable,
    FILE: (0, _babelLiteralToAst2.default)(name),
    LOCATIONS: (0, _babelLiteralToAst2.default)(coverage.entries),
    COUNT: (0, _babelLiteralToAst2.default)(coverage.entries.length)
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9wcmVsdWRlLmpzIl0sIm5hbWVzIjpbInByZWx1ZGUiLCJyZW5kZXIiLCJqb2luIiwiX19kaXJuYW1lIiwic3RhdGUiLCJjb3ZlcmFnZSIsIm5hbWUiLCJmaWxlIiwib3B0cyIsImZpbGVuYW1lUmVsYXRpdmUiLCJnbG9iYWwiLCJHTE9CQUwiLCJTT1VSQ0UiLCJzb3VyY2UiLCJUQUdTIiwidGFncyIsIlZBUklBQkxFIiwidmFyaWFibGUiLCJGSUxFIiwiTE9DQVRJT05TIiwiZW50cmllcyIsIkNPVU5UIiwibGVuZ3RoIl0sIm1hcHBpbmdzIjoiOzs7OztrQkFZd0JBLE87O0FBVnhCOztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7QUFFQSxJQUFNQyxTQUFTLDZCQUFTLHNCQUN0QixlQUFLQyxJQUFMLENBQVVDLFNBQVYsRUFBcUIsSUFBckIsRUFBMkIsT0FBM0IsRUFBb0MsWUFBcEMsQ0FEc0IsRUFDNkIsTUFEN0IsQ0FBVCxDQUFmLEMsQ0FSQTs7QUFZZSxTQUFTSCxPQUFULENBQWlCSSxLQUFqQixFQUF3QjtBQUNyQyxNQUFNQyxXQUFXLG9CQUFLRCxLQUFMLENBQWpCO0FBQ0EsTUFBTUUsT0FBT0YsTUFBTUcsSUFBTixDQUFXQyxJQUFYLENBQWdCQyxnQkFBN0I7QUFDQSxNQUFNQyxTQUFVTixNQUFNSSxJQUFOLElBQWNKLE1BQU1JLElBQU4sQ0FBV0UsTUFBMUIsSUFBcUMsY0FBcEQ7QUFDQSxTQUFPVCxPQUFPO0FBQ1pVLFlBQVEsaUNBQU9ELE1BQVAsQ0FESTtBQUVaRSxZQUFRLGlDQUFPUCxTQUFTUSxNQUFoQixDQUZJO0FBR1pDLFVBQU0saUNBQU9ULFNBQVNVLElBQWhCLENBSE07QUFJWkMsY0FBVVgsU0FBU1ksUUFKUDtBQUtaQyxVQUFNLGlDQUFPWixJQUFQLENBTE07QUFNWmEsZUFBVyxpQ0FBT2QsU0FBU2UsT0FBaEIsQ0FOQztBQU9aQyxXQUFPLGlDQUFPaEIsU0FBU2UsT0FBVCxDQUFpQkUsTUFBeEI7QUFQSyxHQUFQLENBQVA7QUFTRCIsImZpbGUiOiJwcmVsdWRlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZ2xvYmFsIF9fZGlybmFtZSAqL1xuXG5pbXBvcnQge3JlYWRGaWxlU3luY30gZnJvbSAnZnMnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgdGVtcGxhdGUgZnJvbSAnYmFiZWwtdGVtcGxhdGUnO1xuaW1wb3J0IGFzdGlmeSBmcm9tICdiYWJlbC1saXRlcmFsLXRvLWFzdCc7XG5pbXBvcnQgbWV0YSBmcm9tICcuL21ldGEnO1xuXG5jb25zdCByZW5kZXIgPSB0ZW1wbGF0ZShyZWFkRmlsZVN5bmMoXG4gIHBhdGguam9pbihfX2Rpcm5hbWUsICcuLicsICdzaGFyZScsICdwcmVsdWRlLmpzJyksICd1dGY4J1xuKSk7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHByZWx1ZGUoc3RhdGUpIHtcbiAgY29uc3QgY292ZXJhZ2UgPSBtZXRhKHN0YXRlKTtcbiAgY29uc3QgbmFtZSA9IHN0YXRlLmZpbGUub3B0cy5maWxlbmFtZVJlbGF0aXZlO1xuICBjb25zdCBnbG9iYWwgPSAoc3RhdGUub3B0cyAmJiBzdGF0ZS5vcHRzLmdsb2JhbCkgfHwgJ19fY292ZXJhZ2VfXyc7XG4gIHJldHVybiByZW5kZXIoe1xuICAgIEdMT0JBTDogYXN0aWZ5KGdsb2JhbCksXG4gICAgU09VUkNFOiBhc3RpZnkoY292ZXJhZ2Uuc291cmNlKSxcbiAgICBUQUdTOiBhc3RpZnkoY292ZXJhZ2UudGFncyksXG4gICAgVkFSSUFCTEU6IGNvdmVyYWdlLnZhcmlhYmxlLFxuICAgIEZJTEU6IGFzdGlmeShuYW1lKSxcbiAgICBMT0NBVElPTlM6IGFzdGlmeShjb3ZlcmFnZS5lbnRyaWVzKSxcbiAgICBDT1VOVDogYXN0aWZ5KGNvdmVyYWdlLmVudHJpZXMubGVuZ3RoKSxcbiAgfSk7XG59XG4iXX0=